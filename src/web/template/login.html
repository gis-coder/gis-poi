<!DOCTYPE html>
<html>

<head>
    <title>登录</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../css/bootstrap/bootstrap.min.css" rel="stylesheet">
    <script src="../js/bootstrap/bootstrap.min.js"></script>
    <script src="../js/jQuery/jquery.min.js"></script>
    <style type="text/css">
        html {
            height: 100%;
            width: 100%;
            /* background-image: url(../img/login.jpg);
            filter: alpha(opacity=50);
            background-repeat: no-repeat;
            background-size: 100% 100%;
            -moz-background-size: 100% 100%; */
        }

        body {
            background-color: transparent;
        }

        .login {
            margin-top: 10%;
            width: 400px;
            background-color: rgba(255, 255, 255, 1);
            padding: 5px;
            border-radius: 8px;
        }
    </style>
</head>


<body>
    <div class="container login">
        <form role="form-horizontal" method="POST" onsubmit="return false">
            <div class="text-center">
                <h2 class="text-primary" style="margin-bottom: 20px">登录</h2>
            </div>
            <div class="form-group">
                <input id="user_name" class="form-control" type="text" placeholder="请输入用户名">
            </div>
            <div class="form-group">
                <input id="user_password" class="form-control" type="password" placeholder="请输入用户密码">
            </div>
            <!-- <label class="text-left">asdf</label> -->
            <div class="form-group">
                <div class="col-sm-8">
                    <input id="save_password" type="checkbox">记住密码
                </div>
            </div>
            <div class="form-group">
                <button type="button" class="btn btn-primary btn-block btn-lg" onclick="login_click()">登录</button>
            </div>
            <div class="row form group">
                <div class="col-sm-6">
                    <a href="../template/getpass.html">忘记密码</a>
                </div>
                <div class="col-sm-6 text-right">
                    <a href="../template/regist.html">注册</a>
                </div>
            </div>
        </form>
    </div>
    <script type="text/javascript">
        function login_click() {
            // var xmlhttp;
            // if(window.XMLHttpRequest){
            //     xmlhttp = new XMLHttpRequest();
            // }
            // else{
            //     xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            // }

            // xmlhttp.onreadystatechange = function(){
            //     alert(xmlhttp.responseText);
            //     if(xmlhttp.readState == 4 && xmlhttp.states == 200){
            //         alert(xmlhttp.responseText);
            //     }else{
            //         // console.log("请求发送失败");
            //         alert("error");
            //     }
            // }

            // //定义请求类型、请求地址url、确定是否是异步操作
            // xmlhttp.open("POST","http://127.0.0.1:8888/manage/login",true);
            // xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            // xmlhttp.send("fname=henry&lneame=ford");
            var name = document.getElementById('user_name');
            var pass = document.getElementById('user_password');
            var str = '{"username":"' + name.value + '","password":"' + pass.value + '"}'
            postAjax("http://127.0.0.1:8888/manage/login", JSON.parse(str), printJosn);
            
        }

        function printJosn(result) {
            alert(result.state);
            if(result.state){
                self.location = './main.html';
            }
        }

        function postAjax(url, data, success) {
            $.ajax({
                type: "POST",
                url: url,
                data: data,
                async: true,
                dataType: "json",
                success: function (d) {
                    success(d);
                },
                error: function (e) {
                    console.log(e);
                }
            })
        }
    </script>
</body>

</html>